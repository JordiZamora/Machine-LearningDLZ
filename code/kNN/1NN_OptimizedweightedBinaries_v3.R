if (!require("foreach")) install.packages("foreach")
if (!require("doSNOW")) install.packages("doSNOW")
library(class)#install.packages("class")
#Load data
rawdata <- read.csv("../data/Kaggle_Covertype_training.csv")
numcol <- ncol(rawdata)
numrow <- nrow(rawdata)
rawdata[,numcol] <- factor(rawdata[,numcol]) #Classes as factors
#rawdata <- rawdata[1:5000,]

Misclass1NN <- function(weights,rawdata){
  aux <- rawdata[,-c(1,30)]
  columnsAux <- ncol(aux)
  for (i in 11:(columnsAux-1)){
    aux[,i] <- aux[,i]*weights[(i+1)-11]
  }
  
  
  training <- aux
  noObs<-nrow(training)
  cores <- 8
  noBuckets <- 8
  idx <- rep(1:noBuckets, each=ceiling(nrow(training)/noBuckets))
  idx <- idx[sample(1:noObs)]
  training <- data.frame(training,bucket=idx)
  
  BucketsList <- split(seq(1,noBuckets), seq(1,cores))
  
  cl <- makeCluster(cores, type="SOCK", outfile="") 
  registerDoSNOW(cl)  
  
  MisclassErrPar<- foreach(Buckets = BucketsList, .combine = rbind) %dopar% {
    library(class)#install.packages("class")
    MisclassErrBucket <- c()
    for (i in 1:length(Buckets)){    
      ks <- 1
      results<-data.frame(1,1,1)
      testError<-data.frame(1,1)
      cv<-Buckets[i]
      k<-1
      
      traincol <- ncol(training)
      Xtrain <- training[training$bucket != cv, -c(traincol-1, traincol)]  
      Ytrain <- training[training$bucket != cv, (traincol-1)]
      # subsetting the test phase data
      Xtest <- training[training$bucket == cv, -c(traincol-1, traincol)]
      Ytest <- training[training$bucket == cv, (traincol-1)]
      # kNN results
      info<-paste(as.character(cv),as.character(k))
      testPredictions <- knn(train=Xtrain, test=Xtest, cl=Ytrain, k=1)
      MisclassErrBucket[i] <- mean (testPredictions != Ytest)
    }
    MisclassErrBucket
  }
  stopCluster(cl)
  
  MisclassErr <- mean(MisclassErrPar)
  return(MisclassErr)
}

weights <- c(rep(105, 4), rep(98,39))
MisclassErr <- Misclass1NN(weights,rawdata)
#0.08098

MisclassErrOut <- c()
for (i in 1:11){
  weights <- rep(75+50*(i-1)/10, 43)
  cat("i=", i, " ",c(MisclassErr,weights), "\n")
  MisclassErr <- Misclass1NN(weights,rawdata)
  MisclassErrOut <- rbind(MisclassErrOut, c(MisclassErr,weights))
}
# [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14] [,15] [,16] [,17] [,18] [,19]
# [1,] 0.08332   75   75   75   75   75   75   75   75    75    75    75    75    75    75    75    75    75    75
# [2,] 0.08172   80   80   80   80   80   80   80   80    80    80    80    80    80    80    80    80    80    80
# [3,] 0.08106   85   85   85   85   85   85   85   85    85    85    85    85    85    85    85    85    85    85
# [4,] 0.08120   90   90   90   90   90   90   90   90    90    90    90    90    90    90    90    90    90    90
# [5,] 0.08262   95   95   95   95   95   95   95   95    95    95    95    95    95    95    95    95    95    95
# [6,] 0.08260  100  100  100  100  100  100  100  100   100   100   100   100   100   100   100   100   100   100
# [7,] 0.08186  105  105  105  105  105  105  105  105   105   105   105   105   105   105   105   105   105   105
# [8,] 0.08190  110  110  110  110  110  110  110  110   110   110   110   110   110   110   110   110   110   110
# [9,] 0.08146  115  115  115  115  115  115  115  115   115   115   115   115   115   115   115   115   115   115
# [10,] 0.08138  120  120  120  120  120  120  120  120   120   120   120   120   120   120   120   120   120   120
# [11,] 0.08118  125  125  125  125  125  125  125  125   125   125   125   125   125   125   125   125   125   125
# [,20] [,21] [,22] [,23] [,24] [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36] [,37]
# [1,]    75    75    75    75    75    75    75    75    75    75    75    75    75    75    75    75    75    75
# [2,]    80    80    80    80    80    80    80    80    80    80    80    80    80    80    80    80    80    80
# [3,]    85    85    85    85    85    85    85    85    85    85    85    85    85    85    85    85    85    85
# [4,]    90    90    90    90    90    90    90    90    90    90    90    90    90    90    90    90    90    90
# [5,]    95    95    95    95    95    95    95    95    95    95    95    95    95    95    95    95    95    95
# [6,]   100   100   100   100   100   100   100   100   100   100   100   100   100   100   100   100   100   100
# [7,]   105   105   105   105   105   105   105   105   105   105   105   105   105   105   105   105   105   105
# [8,]   110   110   110   110   110   110   110   110   110   110   110   110   110   110   110   110   110   110
# [9,]   115   115   115   115   115   115   115   115   115   115   115   115   115   115   115   115   115   115
# [10,]   120   120   120   120   120   120   120   120   120   120   120   120   120   120   120   120   120   120
# [11,]   125   125   125   125   125   125   125   125   125   125   125   125   125   125   125   125   125   125
# [,38] [,39] [,40] [,41] [,42] [,43] [,44]
# [1,]    75    75    75    75    75    75    75
# [2,]    80    80    80    80    80    80    80
# [3,]    85    85    85    85    85    85    85
# [4,]    90    90    90    90    90    90    90
# [5,]    95    95    95    95    95    95    95
# [6,]   100   100   100   100   100   100   100
# [7,]   105   105   105   105   105   105   105
# [8,]   110   110   110   110   110   110   110
# [9,]   115   115   115   115   115   115   115
# [10,]   120   120   120   120   120   120   120
# [11,]   125   125   125   125   125   125   125


MisclassErrOut <- c()
for (i in 1:43){
  weights <- c(rep(105, 4), rep(98,39))
  weights[i] <- weights[i] + 10
  cat("i=", i, " ",c(MisclassErr,weights), "\n")
  MisclassErr <- Misclass1NN(weights,rawdata)
  MisclassErrOut <- rbind(MisclassErrOut, c(MisclassErr,weights))
}
# [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14] [,15] [,16] [,17] [,18] [,19]
# [1,] 0.08292  115  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [2,] 0.08216  105  115  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [3,] 0.08200  105  105  115  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [4,] 0.08214  105  105  105  115   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [5,] 0.08198  105  105  105  105  108   98   98   98    98    98    98    98    98    98    98    98    98    98
# [6,] 0.08096  105  105  105  105   98  108   98   98    98    98    98    98    98    98    98    98    98    98
# [7,] 0.08084  105  105  105  105   98   98  108   98    98    98    98    98    98    98    98    98    98    98
# [8,] 0.08178  105  105  105  105   98   98   98  108    98    98    98    98    98    98    98    98    98    98
# [9,] 0.08118  105  105  105  105   98   98   98   98   108    98    98    98    98    98    98    98    98    98
# [10,] 0.08208  105  105  105  105   98   98   98   98    98   108    98    98    98    98    98    98    98    98
# [11,] 0.08158  105  105  105  105   98   98   98   98    98    98   108    98    98    98    98    98    98    98
# [12,] 0.08148  105  105  105  105   98   98   98   98    98    98    98   108    98    98    98    98    98    98
# [13,] 0.08202  105  105  105  105   98   98   98   98    98    98    98    98   108    98    98    98    98    98
# [14,] 0.08266  105  105  105  105   98   98   98   98    98    98    98    98    98   108    98    98    98    98
# [15,] 0.08214  105  105  105  105   98   98   98   98    98    98    98    98    98    98   108    98    98    98
# [16,] 0.08160  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98   108    98    98
# [17,] 0.08138  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98   108    98
# [18,] 0.08208  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98   108
# [19,] 0.08182  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [20,] 0.08148  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [21,] 0.08038  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [22,] 0.08246  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [23,] 0.08104  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [24,] 0.08122  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [25,] 0.08154  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [26,] 0.08276  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [27,] 0.08218  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [28,] 0.08206  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [29,] 0.08132  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [30,] 0.08206  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [31,] 0.08182  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [32,] 0.08184  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [33,] 0.08172  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [34,] 0.08220  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [35,] 0.08062  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [36,] 0.08144  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [37,] 0.08212  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [38,] 0.08224  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [39,] 0.08132  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [40,] 0.08060  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [41,] 0.08274  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [42,] 0.08176  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [43,] 0.08186  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [,20] [,21] [,22] [,23] [,24] [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36] [,37]
# [1,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [2,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [3,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [4,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [5,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [6,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [7,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [8,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [9,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [10,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [11,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [12,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [13,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [14,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [15,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [16,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [17,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [18,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [19,]   108    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [20,]    98   108    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [21,]    98    98   108    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [22,]    98    98    98   108    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [23,]    98    98    98    98   108    98    98    98    98    98    98    98    98    98    98    98    98    98
# [24,]    98    98    98    98    98   108    98    98    98    98    98    98    98    98    98    98    98    98
# [25,]    98    98    98    98    98    98   108    98    98    98    98    98    98    98    98    98    98    98
# [26,]    98    98    98    98    98    98    98   108    98    98    98    98    98    98    98    98    98    98
# [27,]    98    98    98    98    98    98    98    98   108    98    98    98    98    98    98    98    98    98
# [28,]    98    98    98    98    98    98    98    98    98   108    98    98    98    98    98    98    98    98
# [29,]    98    98    98    98    98    98    98    98    98    98   108    98    98    98    98    98    98    98
# [30,]    98    98    98    98    98    98    98    98    98    98    98   108    98    98    98    98    98    98
# [31,]    98    98    98    98    98    98    98    98    98    98    98    98   108    98    98    98    98    98
# [32,]    98    98    98    98    98    98    98    98    98    98    98    98    98   108    98    98    98    98
# [33,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98   108    98    98    98
# [34,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98   108    98    98
# [35,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98   108    98
# [36,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98   108
# [37,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [38,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [39,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [40,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [41,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [42,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [43,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [,38] [,39] [,40] [,41] [,42] [,43] [,44]
# [1,]    98    98    98    98    98    98    98
# [2,]    98    98    98    98    98    98    98
# [3,]    98    98    98    98    98    98    98
# [4,]    98    98    98    98    98    98    98
# [5,]    98    98    98    98    98    98    98
# [6,]    98    98    98    98    98    98    98
# [7,]    98    98    98    98    98    98    98
# [8,]    98    98    98    98    98    98    98
# [9,]    98    98    98    98    98    98    98
# [10,]    98    98    98    98    98    98    98
# [11,]    98    98    98    98    98    98    98
# [12,]    98    98    98    98    98    98    98
# [13,]    98    98    98    98    98    98    98
# [14,]    98    98    98    98    98    98    98
# [15,]    98    98    98    98    98    98    98
# [16,]    98    98    98    98    98    98    98
# [17,]    98    98    98    98    98    98    98
# [18,]    98    98    98    98    98    98    98
# [19,]    98    98    98    98    98    98    98
# [20,]    98    98    98    98    98    98    98
# [21,]    98    98    98    98    98    98    98
# [22,]    98    98    98    98    98    98    98
# [23,]    98    98    98    98    98    98    98
# [24,]    98    98    98    98    98    98    98
# [25,]    98    98    98    98    98    98    98
# [26,]    98    98    98    98    98    98    98
# [27,]    98    98    98    98    98    98    98
# [28,]    98    98    98    98    98    98    98
# [29,]    98    98    98    98    98    98    98
# [30,]    98    98    98    98    98    98    98
# [31,]    98    98    98    98    98    98    98
# [32,]    98    98    98    98    98    98    98
# [33,]    98    98    98    98    98    98    98
# [34,]    98    98    98    98    98    98    98
# [35,]    98    98    98    98    98    98    98
# [36,]    98    98    98    98    98    98    98
# [37,]   108    98    98    98    98    98    98
# [38,]    98   108    98    98    98    98    98
# [39,]    98    98   108    98    98    98    98
# [40,]    98    98    98   108    98    98    98
# [41,]    98    98    98    98   108    98    98
# [42,]    98    98    98    98    98   108    98
# [43,]    98    98    98    98    98    98   108


MisclassErrOut <- c()
for (i in 1:43){
  weights <- c(rep(105, 4), rep(98,39))
  weights[i] <- weights[i] - 10
  cat("i=", i, " ",c(MisclassErr,weights), "\n")
  MisclassErr <- Misclass1NN(weights,rawdata)
  MisclassErrOut <- rbind(MisclassErrOut, c(MisclassErr,weights))
}
# [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13] [,14] [,15] [,16] [,17] [,18] [,19]
# [1,] 0.08300   95  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [2,] 0.08206  105   95  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [3,] 0.08084  105  105   95  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [4,] 0.08150  105  105  105   95   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [5,] 0.08094  105  105  105  105   88   98   98   98    98    98    98    98    98    98    98    98    98    98
# [6,] 0.08192  105  105  105  105   98   88   98   98    98    98    98    98    98    98    98    98    98    98
# [7,] 0.08134  105  105  105  105   98   98   88   98    98    98    98    98    98    98    98    98    98    98
# [8,] 0.08300  105  105  105  105   98   98   98   88    98    98    98    98    98    98    98    98    98    98
# [9,] 0.08216  105  105  105  105   98   98   98   98    88    98    98    98    98    98    98    98    98    98
# [10,] 0.08100  105  105  105  105   98   98   98   98    98    88    98    98    98    98    98    98    98    98
# [11,] 0.08040  105  105  105  105   98   98   98   98    98    98    88    98    98    98    98    98    98    98
# [12,] 0.08206  105  105  105  105   98   98   98   98    98    98    98    88    98    98    98    98    98    98
# [13,] 0.08222  105  105  105  105   98   98   98   98    98    98    98    98    88    98    98    98    98    98
# [14,] 0.08128  105  105  105  105   98   98   98   98    98    98    98    98    98    88    98    98    98    98
# [15,] 0.08060  105  105  105  105   98   98   98   98    98    98    98    98    98    98    88    98    98    98
# [16,] 0.08148  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    88    98    98
# [17,] 0.08074  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    88    98
# [18,] 0.08150  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    88
# [19,] 0.08248  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [20,] 0.08104  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [21,] 0.08138  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [22,] 0.08112  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [23,] 0.08230  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [24,] 0.08108  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [25,] 0.08138  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [26,] 0.08268  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [27,] 0.08192  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [28,] 0.08126  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [29,] 0.08196  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [30,] 0.08138  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [31,] 0.08206  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [32,] 0.08232  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [33,] 0.08166  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [34,] 0.08192  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [35,] 0.08244  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [36,] 0.08182  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [37,] 0.08150  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [38,] 0.08248  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [39,] 0.08094  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [40,] 0.08134  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [41,] 0.08138  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [42,] 0.08190  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [43,] 0.08248  105  105  105  105   98   98   98   98    98    98    98    98    98    98    98    98    98    98
# [,20] [,21] [,22] [,23] [,24] [,25] [,26] [,27] [,28] [,29] [,30] [,31] [,32] [,33] [,34] [,35] [,36] [,37]
# [1,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [2,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [3,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [4,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [5,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [6,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [7,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [8,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [9,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [10,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [11,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [12,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [13,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [14,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [15,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [16,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [17,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [18,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [19,]    88    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [20,]    98    88    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [21,]    98    98    88    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [22,]    98    98    98    88    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [23,]    98    98    98    98    88    98    98    98    98    98    98    98    98    98    98    98    98    98
# [24,]    98    98    98    98    98    88    98    98    98    98    98    98    98    98    98    98    98    98
# [25,]    98    98    98    98    98    98    88    98    98    98    98    98    98    98    98    98    98    98
# [26,]    98    98    98    98    98    98    98    88    98    98    98    98    98    98    98    98    98    98
# [27,]    98    98    98    98    98    98    98    98    88    98    98    98    98    98    98    98    98    98
# [28,]    98    98    98    98    98    98    98    98    98    88    98    98    98    98    98    98    98    98
# [29,]    98    98    98    98    98    98    98    98    98    98    88    98    98    98    98    98    98    98
# [30,]    98    98    98    98    98    98    98    98    98    98    98    88    98    98    98    98    98    98
# [31,]    98    98    98    98    98    98    98    98    98    98    98    98    88    98    98    98    98    98
# [32,]    98    98    98    98    98    98    98    98    98    98    98    98    98    88    98    98    98    98
# [33,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    88    98    98    98
# [34,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    88    98    98
# [35,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    88    98
# [36,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    88
# [37,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [38,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [39,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [40,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [41,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [42,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [43,]    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98    98
# [,38] [,39] [,40] [,41] [,42] [,43] [,44]
# [1,]    98    98    98    98    98    98    98
# [2,]    98    98    98    98    98    98    98
# [3,]    98    98    98    98    98    98    98
# [4,]    98    98    98    98    98    98    98
# [5,]    98    98    98    98    98    98    98
# [6,]    98    98    98    98    98    98    98
# [7,]    98    98    98    98    98    98    98
# [8,]    98    98    98    98    98    98    98
# [9,]    98    98    98    98    98    98    98
# [10,]    98    98    98    98    98    98    98
# [11,]    98    98    98    98    98    98    98
# [12,]    98    98    98    98    98    98    98
# [13,]    98    98    98    98    98    98    98
# [14,]    98    98    98    98    98    98    98
# [15,]    98    98    98    98    98    98    98
# [16,]    98    98    98    98    98    98    98
# [17,]    98    98    98    98    98    98    98
# [18,]    98    98    98    98    98    98    98
# [19,]    98    98    98    98    98    98    98
# [20,]    98    98    98    98    98    98    98
# [21,]    98    98    98    98    98    98    98
# [22,]    98    98    98    98    98    98    98
# [23,]    98    98    98    98    98    98    98
# [24,]    98    98    98    98    98    98    98
# [25,]    98    98    98    98    98    98    98
# [26,]    98    98    98    98    98    98    98
# [27,]    98    98    98    98    98    98    98
# [28,]    98    98    98    98    98    98    98
# [29,]    98    98    98    98    98    98    98
# [30,]    98    98    98    98    98    98    98
# [31,]    98    98    98    98    98    98    98
# [32,]    98    98    98    98    98    98    98
# [33,]    98    98    98    98    98    98    98
# [34,]    98    98    98    98    98    98    98
# [35,]    98    98    98    98    98    98    98
# [36,]    98    98    98    98    98    98    98
# [37,]    88    98    98    98    98    98    98
# [38,]    98    88    98    98    98    98    98
# [39,]    98    98    88    98    98    98    98
# [40,]    98    98    98    88    98    98    98
# [41,]    98    98    98    98    88    98    98
# [42,]    98    98    98    98    98    88    98
# [43,]    98    98    98    98    98    98    88

MisclassErrOut <- c()
weights <- c(rep(105, 4), rep(98,39))
wplus <- c(21,35,40)
weights[wplus] <- weights[wplus] + 10
wminus <- c(11,15,17)
weights[wminus] <- weights[wminus] - 10
MisclassErr <- Misclass1NN(weights,rawdata)
MisclassErr
#0.08226

MisclassErrOut <- c()
weights <- c(rep(105, 4), rep(98,39))
wplus <- c(21,35,40)
weights[wplus] <- weights[wplus] + 20
wminus <- c(11,15,17)
weights[wminus] <- weights[wminus] - 20
MisclassErr <- Misclass1NN(weights,rawdata)
MisclassErr
#0.0825